import nmrpy


p = nmrpy.fid_from_path('data.fid')
p.emhz(lb=5)
p.zf()
p.ft()
p.data = p.data[11:]
p.phase_auto(method='area', mp=True)


p.bl_points = [   0,   35,   44,   52,  158,  167,  211,  273,  281,  299,  317,
        325,  361,  369,  458,  475,  581,  590,  643,  660,  713,  722,
        810,  819,  854,  872,  889,  951,  960, 1030, 1057, 1074, 1083,
       1092, 1109, 1118, 1127, 1136, 1171, 1180, 1197, 1206, 1215, 1224,
       1242, 1250, 2660, 2669, 2783, 2836, 2862, 2880, 2977, 2994, 2994,
       3003, 3003, 3012, 3021, 3100, 3109, 3127, 3135, 3188, 3223, 3232,
       3267, 3356, 3417, 3435, 3452, 3488, 3523, 3541, 3567, 3576, 5408,
       5434, 5443, 5567, 5584, 5699, 5752, 5778, 5848, 5892, 5901, 5928,
       5972, 6025, 6113, 6157, 6174, 6262, 6271, 6280, 6306, 6315, 6351,
       6359, 6403, 6412, 6509, 6527, 6588, 6597, 6615, 6624, 6676, 6712,
       8015, 8024, 8077, 8095, 8112, 8121, 8139, 8147, 8156, 8165, 8191]


p.bl_fit()

p.peaks = [[ 1558,  1655,  1684,  1755,
        1782,  1817,  1869],
 [ 2461,  2466,  2473],
 [ 4160,  4280]]

p.ranges = [[1469, 1964],
 [2385, 2532],
 [3737, 4687]]

labels = {
 'FBP-A1': 3.286,
 'G6P-B': 2.88,
 'G6P-A': 2.754,
 'F6P': 2.341,
 'FBP-B1': 2.456,
 'FBP-B2': 2.189,
 'FBP-A2': 1.964}

p.plot_array_ppm(sw_left=10, plotrange=[4.0,1.5], filled=True, labels=labels)

p.deconv()
p.plot_deconv(29, sw_left=10)

names = ['TEP', 'G6P', 'F6P', 'FBP', 'ATP', 'ADP']
peak_index = [[7,8,9], [1,2], [4], [0,3], [10], [11]]
p.f_integral_sums(names, peak_index)

p.integrals_sum *= 5.0/p.integrals_sum[0]
p.f_splines(k=2, s=1e20)
p.f_plot_splines()




